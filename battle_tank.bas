0 REM
0 REM                               
0 REM        BATTLE TANK            
0 REM                               
0 REM      By   K.Kuromusha         
0 REM                               
0 REM   1983/12/17       No.5       
0 REM                               
0 REM
10 CONSOLEC40,S0,24,N:GRAPHI1,C,O1
20 GOSUB 3340:GOSUB 3630
30 PRINTCHR$(6):GRAPHO:GOSUB 3260
40 FORI=1TO10
50 Z(X(I),Y(I))=1
60 Y=(Y(I)-1)*12+6
70 X=(X(I)/2-1)*12+8
80 IFINT(X(I)/2)*2=X(I)GOTO 100
90 X=(X(I)-1)/2*12+2
100 POSITIONX,Y
110 PATTERN-8,H$(I):NEXT
120 FORI=1TO18
130 Z(E(I),F(I))=1
140 Y=(F(I)-1)*12+6
150 X=(E(I)/2-1)*12+8
160 IFINT(E(I)/2)*2=E(I)GOTO 180
170 X=(E(I)-1)/2*12+2
180 POSITIONX,Y
190 PATTERN-8,L$(I):NEXT:GRAPHO1
200 NO=0
210 PRINTCHR$(6):NO=NO+1:CURSOR11,24:PRINTNO;"-TURN";
220 CURSOR32,4:PRINT"YOU"
230 CURSOR35,6:PRINT"MOVE"
240 FORI=1TO10:IFB(I)=0GOTO 700
250 CURSOR32,10:PRINTA$(I);"-޳"
260 GETG$:IFG$=""GOTO 260
270 IFG$=" "GOTO 2380
280 IFG$="S"GOTO 700
290 IFG$="A"THENG=2:H=0
300 IFG$="B"THENG=1:H=-1
310 IFG$="C"THENG=-1:H=-1
320 IFG$="D"THENG=-2:H=0
330 IFG$="E"THENG=-1:H=1
340 IFG$="F"THENG=1:H=1
350 IFG$="G"THENG=4:H=0:Q=1
360 IFG$="H"THENG=3:H=-1:Q=2
370 IFG$="I"THENG=2:H=-2:Q=3
380 IFG$="J"THENG=0:H=-2:Q=4
390 IFG$="K"THENG=-2:H=-2:Q=5
400 IFG$="L"THENG=-3:H=-1:Q=6
410 IFG$="M"THENG=-4:H=0:Q=7
420 IFG$="N"THENG=-3:H=1:Q=8
430 IFG$="O"THENG=-2:H=2:Q=9
440 IFG$="P"THENG=0:H=2:Q=10
450 IFG$="Q"THENG=2:H=2:Q=11
460 IFG$="R"THENG=3:H=1:Q=12
470 IF(G=0)*(H=0)GOTO 260
480 IFX(I)+G>41GOTO 260
490 IFX(I)+G<1GOTO 260
500 IFY(I)+H>15GOTO 260
510 IFY(I)+H<1GOTO 260
520 IFZ(X(I)+G,Y(I)+H)=1GOTO 260
530 IFASC(G$)-70<1GOTO 550
540 GOTO 2520
550 Z(X(I),Y(I))=0
560 Y=(Y(I)-1)*12+6
570 X=(X(I)/2-1)*12+8
580 IFINT(X(I)/2)*2=X(I)GOTO 600
590 X=(X(I)-1)/2*12+2
600 POSITIONX,Y
610 PATTERN-8,CL$
620 X(I)=X(I)+G:Y(I)=Y(I)+H
630 Z(X(I),Y(I))=1
640 Y=(Y(I)-1)*12+6
650 X=(X(I)/2-1)*12+8
660 IFINT(X(I)/2)*2=X(I)GOTO 680
670 X=(X(I)-1)/2*12+2
680 POSITIONX,Y
690 PATTERN-8,H$(I)
700 NEXT
710 CURSOR33,6:PRINT"BATTLE"
720 FORI=1TO10:IFB(I)=0GOTO 1040
730 CURSOR32,10:PRINTA$(I);"-޷"
740 CURSOR33,12:PRINT"خ-";STR$(A(I))
750 CURSOR33,14:PRINT"       "
760 GETG$:IFG$=""GOTO 760
770 IFG$=" "GOTO 1040
780 IFG$="S"THENG=15:GOTO 840
790 IFG$="X"THENG=16:GOTO 840
800 IFG$="Y"THENG=17:GOTO 840
810 IFG$="Z"THENG=18:GOTO 840
820 G=ASC(G$)-64
830 IF(G<1)+(G>14)GOTO 760
840 IFD(G)=0GOTO 760
850 X1=ABS(X(I)-E(G))+1:Y1=ABS(Y(I)-F(G))
860 Z1=INT(SQR(X1^2+Y1^2))*2
870 Z2=A(I)+INT(RND(1)*6+1)
880 IFZ1<1THENZ1=1
890 Z3=INT(Z2/Z1)
900 D(G)=D(G)-Z3
910 IFZ3<1GOTO 940
920 IFD(G)<1GOTO 950
930 CURSOR33,14:PRINTB$(G);"-ݼ":GOTO 1030
940 CURSOR33,14:PRINTB$(G);"-˶޲":GOTO 1030
950 D(G)=0:Z(E(G),F(G))=0
960 CURSOR34,14:PRINTB$(G);"-޷"
970 Y=(F(G)-1)*12+6
980 X=(E(G)/2-1)*12+8
990 IFINT(E(G)/2)*2=E(G)GOTO 1010
1000 X=(E(G)-1)/2*12+2
1010 POSITIONX,Y
1020 PATTERN-8,CL$
1030 MUSIC"R9"
1040 NEXT
1050 CURSOR32,10:PRINT" "
1060 CURSOR33,12:PRINT"       "
1070 CURSOR33,14:PRINT"       "
1080 CURSOR32,4:PRINT"COM"
1090 CURSOR33,6:PRINT"  MOVE"
1100 FORI=1TO14:IFD(I)=0GOTO 1540
1110 CURSOR33,10:PRINTB$(I);"-޳ "
1120 J=INT(RND(1)*18+1)
1130 IFJ=1THENG=2:H=0
1140 IFJ=2THENG=1:H=-1
1150 IFJ=3THENG=-1:H=-1
1160 IFJ=4THENG=-2:H=0
1170 IFJ=5THENG=-1:H=1
1180 IFJ=6THENG=1:H=1
1190 IFJ=7THENG=4:H=0:Q=1
1200 IFJ=8THENG=3:H=-1:Q=2
1210 IFJ=9THENG=2:H=-2:Q=3
1220 IFJ=10THENG=0:H=-2:Q=4
1230 IFJ=11THENG=-2:H=-2:Q=5
1240 IFJ=12THENG=-3:H=-1:Q=6
1250 IFJ=13THENG=-4:H=0:Q=7
1260 IFJ=14THENG=-3:H=1:Q=8
1270 IFJ=15THENG=-2:H=2:Q=9
1280 IFJ=16THENG=0:H=2:Q=10
1290 IFJ=17THENG=2:H=2:Q=11
1300 IFJ=18THENG=3:H=1:Q=12
1310 IFE(I)+G>41GOTO 1530
1320 IFE(I)+G<1GOTO 1530
1330 IFF(I)+H>15GOTO 1530
1340 IFF(I)+H<1GOTO 1530
1350 IFZ(E(I)+G,F(I)+H)=1GOTO 1530
1360 IFJ<7GOTO 1380
1370 GOTO 2890
1380 Z(E(I),F(I))=0
1390 Y=(F(I)-1)*12+6
1400 X=(E(I)/2-1)*12+8
1410 IFINT(E(I)/2)*2=E(I)GOTO 1430
1420 X=(E(I)-1)/2*12+2
1430 POSITIONX,Y
1440 PATTERN-8,CL$
1450 E(I)=E(I)+G:F(I)=F(I)+H
1460 Z(E(I),F(I))=1
1470 Y=(F(I)-1)*12+6
1480 X=(E(I)/2-1)*12+8
1490 IFINT(E(I)/2)*2=E(I)GOTO 1510
1500 X=(E(I)-1)/2*12+2
1510 POSITIONX,Y
1520 PATTERN-8,L$(I)
1530 MUSIC"R9"
1540 NEXT
1550 CURSOR33,6:PRINT"BATTLE"
1560 FORI=1TO18:IFD(I)=0GOTO 2030
1570 CURSOR33,10:PRINTB$(I);"-޷"
1580 CURSOR32,14:PRINT"        "
1590 FORJ=1TO10:IFB(J)=0THENZZ(J)=999:GOTO 1620
1600 ZX(J)=ABS(X(J)-E(I))+1:ZY(J)=ABS(Y(J)-F(I))
1610 ZZ(J)=INT(SQR(ZX(J)^2+ZY(J)^2))*2
1620 NEXT
1630 B1=0:B2=0:B3=0:B4=0:B5=0:B6=0:B7=0:B8=0:B9=0:B0=0
1640 FORJ=1TO10
1650 IFZZ(1)=<ZZ(J)THENB1=B1+1
1660 IFZZ(2)=<ZZ(J)THENB2=B2+1
1670 IFZZ(3)=<ZZ(J)THENB3=B3+1
1680 IFZZ(4)=<ZZ(J)THENB4=B4+1
1690 IFZZ(5)=<ZZ(J)THENB5=B5+1
1700 IFZZ(6)=<ZZ(J)THENB6=B6+1
1710 IFZZ(7)=<ZZ(J)THENB7=B7+1
1720 IFZZ(8)=<ZZ(J)THENB8=B8+1
1730 IFZZ(9)=<ZZ(J)THENB9=B9+1
1740 IFZZ(10)=<ZZ(J)THENB0=B0+1
1750 NEXT
1760 IFB1=10THENBA=1:GOTO 1860
1770 IFB2=10THENBA=2:GOTO 1860
1780 IFB3=10THENBA=3:GOTO 1860
1790 IFB4=10THENBA=4:GOTO 1860
1800 IFB5=10THENBA=5:GOTO 1860
1810 IFB6=10THENBA=6:GOTO 1860
1820 IFB7=10THENBA=7:GOTO 1860
1830 IFB8=10THENBA=8:GOTO 1860
1840 IFB9=10THENBA=9:GOTO 1860
1850 IFB0=10THENBA=10
1860 BT=C(I)+INT(RND(1)*6+1)
1870 IFZZ(BA)<1THENZZ(BA)=1
1880 BL=INT(BT/ZZ(BA))
1890 B(BA)=B(BA)-BL
1900 IFBL<1GOTO 1930
1910 IFB(BA)<1GOTO 1940
1920 CURSOR32,14:PRINTA$(BA);"-ݼ":GOTO 2020
1930 CURSOR32,14:PRINTA$(BA);"-˶޲":GOTO 2020
1940 B(BA)=0:Z(X(BA),Y(BA))=0
1950 CURSOR33,14:PRINTA$(BA);"-޷"
1960 Y=(Y(BA)-1)*12+6
1970 X=(X(BA)/2-1)*12+8
1980 IFINT(X(BA)/2)*2=X(BA)GOTO 2000
1990 X=(X(BA)-1)/2*12+2
2000 POSITIONX,Y
2010 PATTERN-8,CL$
2020 MUSIC"R9"
2030 NEXT
2040 YO=0:FORI=1TO10:IFB(I)=0THENYO=YO+1
2050 NEXT:IFYO=10GOTO 2090
2060 YO=0:FORI=1TO18:IFD(I)=0THENYO=YO+1
2070 NEXT:IFYO=18GOTO 2090
2080 IFNO<8GOTO 210
2090 CURSOR4,24
2100 PRINT"***** GAME OVER *****";
2110 FORI=1TO15:MUSIC"C0DEFGABAGFEDC":NEXT
2120 P1=0:P2=0
2130 FORI=1TO10
2140 IFB(I)=0THENP1=P1+10
2150 NEXT
2160 FORI=1TO7
2170 IFD(I)=0THENP2=P2+4
2180 NEXT
2190 FORI=8TO14
2200 IFD(I)=0THENP2=P2+7
2210 NEXT
2220 IFD(15)=0THENP2=P2+14
2230 FORI=16TO18
2240 IFD(I)=0THENP2=P2+3
2250 NEXT
2260 T=0:FORI=1TO7
2270 IFD(I)=0THENT=T+1
2280 NEXT:IFT<>7THENP2=P2-14
2290 PRINTCHR$(6):GRAPHC
2300 CURSOR10,3:PRINT"***** POINT *****"
2310 CURSOR8,7:PRINT"YOU";TAB(25);P2;" POINT"
2320 CURSOR8,9:PRINT"COM";TAB(25);P1;" POINT"
2330 P$="YOU"
2340 IFP2<P1THENP$="COM"
2350 LINE47,120,240,120,240,143,47,143,47,120
2360 CURSOR7,16:PRINT"<<<<< ";P$;"   >>>>>"
2370 END
2380 GRAPHO:PRINTCHR$(5);
2390 PRINT""
2400 FORJ=1TO21:PRINT"";SPACE$(29);""
2410 NEXT:PRINT""
2420 CURSOR6,4:PRINT"***** UNIT *****"
2430 FORJ=1TO10
2440 CURSOR8,6+J:PRINTA$(J);" -";A(J);" -";LEFT$(" ",2-LEN(STR$(B(J))));B(J)
2450 NEXT
2460 CURSOR6,19:PRINT"PUSH [SPACE] KEY"
2470 GETG$:IFG$<>" "GOTO 2470
2480 PRINTCHR$(5);
2490 FORJ=1TO23:PRINTSPACE$(32)
2500 NEXT:GRAPHO1
2510 GOTO 260
2520 ONQGOTO 2530, 2550, 2570, 2590, 2670, 2690, 2710, 2730, 2750, 2770, 2850, 2870
2530 IFZ(X(I)+2,Y(I))=0GOTO 550
2540 GOTO 260
2550 IF(Z(X(I)+2,Y(I))=0)+(Z(X(I)+1,Y(I)-1)=0)GOTO 550
2560 GOTO 260
2570 IFZ(X(I)+1,Y(I)-1)=0GOTO 550
2580 GOTO 260
2590 IFX(I)=1GOTO 2630
2600 IFX(I)=41GOTO 2650
2610 IF(Z(X(I)+1,Y(I)-1)=0)+(Z(X(I)-1,Y(I)-1)=0)GOTO 550
2620 GOTO 260
2630 IFZ(X(I)+1,Y(I)-1)=0GOTO 550
2640 GOTO 260
2650 IFZ(X(I)-1,Y(I)-1)=0GOTO 550
2660 GOTO 260
2670 IFZ(X(I)-1,Y(I)-1)=0GOTO 550
2680 GOTO 260
2690 IF(Z(X(I)-1,Y(I)-1)=0)+(Z(X(I)-2,Y(I))=0)GOTO 550
2700 GOTO 260
2710 IFZ(X(I)-2,Y(I))=0GOTO 550
2720 GOTO 260
2730 IF(Z(X(I)-2,Y(I))=0)+(Z(X(I)-1,Y(I)+1)=0)GOTO 550
2740 GOTO 260
2750 IFZ(X(I)-1,Y(I)+1)=0GOTO 550
2760 GOTO 260
2770 IFX(I)=1GOTO 2810
2780 IFX(I)=41GOTO 2830
2790 IF(Z(X(I)-1,Y(I)+1)=0)+(Z(X(I)+1,Y(I)+1)=0)GOTO 550
2800 GOTO 260
2810 IFZ(X(I)+1,Y(I)+1)=0GOTO 550
2820 GOTO 260
2830 IFZ(X(I)-1,Y(I)+1)=0GOTO 550
2840 GOTO 260
2850 IFZ(X(I)+1,Y(I)+1)=0GOTO 550
2860 GOTO 260
2870 IF(Z(X(I)+1,Y(I)+1)=0)+(Z(X(I)+2,Y(I))=0)GOTO 550
2880 GOTO 260
2890 ONQGOTO 2900, 2920, 2940, 2960, 3040, 3060, 3080, 3100, 3120, 3140, 3220, 3240
2900 IFZ(E(I)+2,F(I))=0GOTO 1380
2910 GOTO 1530
2920 IF(Z(E(I)+2,F(I))=0)+(Z(E(I)+1,F(I)-1)=0)GOTO 1380
2930 GOTO 1530
2940 IFZ(E(I)+1,F(I)-1)=0GOTO 1380
2950 GOTO 1530
2960 IFE(I)=1GOTO 3000
2970 IFE(I)=41GOTO 3020
2980 IF(Z(E(I)+1,F(I)-1)=0)+(Z(E(I)-1,F(I)-1)=0)GOTO 1380
2990 GOTO 1530
3000 IFZ(E(I)+1,F(I)-1)=0GOTO 1380
3010 GOTO 1530
3020 IFZ(E(I)-1,F(I)-1)=0GOTO 1380
3030 GOTO 1530
3040 IFZ(E(I)-1,F(I)-1)=0GOTO 1380
3050 GOTO 1530
3060 IF(Z(E(I)-1,F(I)-1)=0)+(Z(E(I)-2,F(I))=0)GOTO 1380
3070 GOTO 1530
3080 IFZ(E(I)-2,F(I))=0GOTO 1380
3090 GOTO 1530
3100 IF(Z(E(I)-2,F(I))=0)+(Z(E(I)-1,F(I)+1)=0)GOTO 1380
3110 GOTO 1530
3120 IFZ(E(I)-1,F(I)+1)=0GOTO 1380
3130 GOTO 1530
3140 IFE(I)=1GOTO 3180
3150 IFE(I)=41GOTO 3200
3160 IF(Z(E(I)-1,F(I)+1)=0)+(Z(E(I)+1,F(I)+1)=0)GOTO 1380
3170 GOTO 1530
3180 IFZ(E(I)+1,F(I)+1)=0GOTO 1380
3190 GOTO 1530
3200 IFZ(E(I)-1,F(I)+1)=0GOTO 1380
3210 GOTO 1530
3220 IFZ(E(I)+1,F(I)+1)=0GOTO 1380
3230 GOTO 1530
3240 IF(Z(E(I)+1,F(I)+1)=0)+(Z(E(I)+2,F(I))=0)GOTO 1380
3250 GOTO 1530
3260 FORJ=0TO250STEP12:FORI=0TO191STEP24
3270 LINEJ+6,I,J,I+6,J,I+12,J+6,I+18,J+6,I+24
3280 NEXTI,J
3290 FORJ=12TO258STEP12:FORI=0TO191STEP24
3300 LINEJ-6,I,J,I+6,J,I+12,J-6,I+18,J-6,I+24
3310 NEXTI,J
3320 FORI=187TO192:BLINE0,I,319,I
3330 NEXT:RETURN
3340 DIMA$(10),B$(18),A(10),B(10),C(18),D(18),X(10),Y(10),E(18),F(18)
3350 DIMH$(10),L$(18),Z(41,15),ZX(10),ZY(10),ZZ(10)
3360 FORI=1TO10:READA$(I),A(I),B(I),X(I),Y(I):NEXT
3370 FORI=1TO18:READB$(I),C(I),D(I),E(I),F(I):NEXT
3380 FORI=1TO9
3390 READG$:H$(I)=G$
3400 NEXT
3410 FORI=2TO8
3420 READG$:L$(I)=G$
3430 NEXT
3440 FORI=11TO15
3450 READG$:L$(I)=G$
3460 NEXT
3470 L$(1)=CHR$(24)+"$B"
3480 L$(9)=">"+STRING$(CHR$(8),6)+">"
3490 L$(10)=">"+STRING$(CHR$(8),4)+"P "
3500 L$(16)="B$"+CHR$(24)+CHR$(24)+"$B"
3510 L$(17)="A"+CHR$(34)+CHR$(20)+STRING$(CHR$(8),5)
3520 L$(18)=""+CHR$(8)+CHR$(16)+" @"
3530 H$(10)=CHR$(23)+STRING$(CHR$(21),6)+CHR$(23)
3540 T1$="00000??00000"
3550 T2$=""+CHR$(12)+CHR$(12)+"0000"+CHR$(12)+CHR$(12)+""
3560 T3$=""
3570 T4$=""+STRING$(CHR$(0),14)+""
3580 T5$=""+STRING$(CHR$(0),5)+""+STRING$(CHR$(0),5)+""
3590 T6$="33"+CHR$(15)+CHR$(15)+""
3600 T7$=""+CHR$(15)+"<"+STRING$(CHR$(0),6)+"<"+CHR$(15)+""
3610 CL$=STRING$(CHR$(0),8)
3620 RETURN
3630 POSITION10,70:PATTERN-16,T1$
3640 GOSUB 4010
3650 POSITION30,70:PATTERN-16,T2$
3660 GOSUB 4010
3670 POSITION50,70:PATTERN-16,T3$
3680 GOSUB 4010
3690 POSITION70,70:PATTERN-16,T3$
3700 GOSUB 4010
3710 POSITION90,70:PATTERN-16,T4$
3720 GOSUB 4010
3730 POSITION110,70:PATTERN-16,T5$
3740 GOSUB 4010:GOSUB 4010
3750 POSITION170,70:PATTERN-16,T3$
3760 GOSUB 4010
3770 POSITION190,70:PATTERN-16,T2$
3780 GOSUB 4010
3790 POSITION210,70:PATTERN-16,T6$
3800 GOSUB 4010
3810 POSITION230,70:PATTERN-16,T7$
3820 GOSUB 4010
3830 CURSOR20,15:PRINT"By K.Kuromusha"
3840 TEMPO7
3850 FORI=0TO30:MUSIC"-B0E-BDF":NEXT
3860 GRAPHC:PRINTCHR$(6)
3870 CURSOR6,3:PRINT"********** UNIT **********"
3880 FORI=1TO10:CURSOR0,6+I
3890 PRINTA$(I);" -";A(I);" -";B(I)
3900 NEXT
3910 FORI=1TO10:CURSOR15,6+I
3920 PRINTB$(I);" -";LEFT$(" ",2-LEN(STR$(C(I))));C(I);" -";LEFT$(" ",2-LEN(STR$(D(I))));D(I)
3930 NEXT
3940 FORI=11TO18:CURSOR29,I-4
3950 PRINTB$(I);" -";LEFT$(" ",2-LEN(STR$(C(I))));C(I);" -";LEFT$(" ",2-LEN(STR$(D(I))));D(I)
3960 NEXT
3970 CURSOR10,20:PRINT"PUSH  [SPACE]  KEY"
3980 GETG$:IFG$<>" "GOTO 3980
3990 RETURN
4000 ,6:PRINT"YOU          COM"
4010 FORI=0TO500:NEXT:RETURN
4020 DATA" 1",15,13,4,6
4030 DATA" 2",15,14,5,9
4040 DATA" 3",15,14,7,7
4050 DATA" 4",14,14,8,4
4060 DATA" 5",14,15,3,3
4070 DATA" 6",14,16,16,8
4080 DATA" 7",13,17,11,13
4090 DATA" 8",12,17,34,12
4100 DATA" 9",11,17,25,1
4110 DATA"10",10,20,6,2
4120 DATAA,6,11,22,4
4130 DATAB,6,10,13,11
4140 DATAC,7,9,28,8
4150 DATAD,8,9,23,7
4160 DATAE,9,8,25,11
4170 DATAF,9,8,7,5
4180 DATAG,10,8,37,5
4190 DATAH,15,13,38,14
4200 DATAI,14,13,18,14
4210 DATAJ,13,13,19,5
4220 DATAK,13,14,9,5
4230 DATAL,12,14,27,5
4240 DATAM,11,16,27,15
4250 DATAN,11,16,28,12
4260 DATAS,9,30,21,11
4270 DATAX,25,7,16,2
4280 DATAY,25,7,31,3
4290 DATAZ,25,7,4,14
4300 DATAqQQQQQQq,wQQWTTTw
4310 DATAwQQWQQQw,uUUUWQQq
4320 DATAwTTWQQQw,wTTWUUUw
4330 DATAwUUQQQQq,wUUWUUUw
4340 DATAwUUUWQQw,AA~AAA
4350 DATA>AA>,BAAAAB
4360 DATA,
4370 DATA>AC=,
4380 DATAȄ,
4390 DATAå,
4400 DATA~~~
